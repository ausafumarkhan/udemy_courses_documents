
<!DOCTYPE html>
<html lang='en'>
<head>
<title>Orchestrating the Cloud with Kubernetes | Google Cloud Skills Boost for Partners</title>
<meta name="action-cable-url" content="/cable" />
<script>
//<![CDATA[
window.gon={};gon.deployment="googlecourses-run";
//]]>
</script>
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-5XSKHDX");
</script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/polyfills/webcomponents-loader-8583b47b01e40e6ea7bf1ad443a20b7e79bbdd5eafac009806a228c91a97282c.js"></script>
<script src="https://cdn.qwiklabs.com/assets/vendor-beb958bea8eff6a4ad4cf8f36a0a676817a4857e214b17ae983796071a4a816d.js"></script>
<script src="https://cdn.qwiklabs.com/assets/application-8194cda6ef3c11dc4405ed62cf7fc7697cbe39d472be22a7c9d4bd377a7b77f0.js"></script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/hallofmirrors-f8d9fcf289db0acb0062699ca48080cfaf9b1703f4acd2d7d8bacd8bb0bedf3d.js"></script>
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script id='ze-snippet' src='https://static.zdassets.com/ekr/snippet.js?key=511e4158-0aec-4e3c-b2e6-4daa1769f51e'></script>
<script>
  ql.perfTest.init();
</script>


<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="BgXUHdnGORFTCIDjAQTKvR1dAgqK6z+TN2QJ8nJNd0qlnxXKUMwLlQjUj6OmZroqcs2D7YM0ueCBuos907ov3A==" />
<meta content='width=device-width, initial-scale=1.0, user-scalable=yes' name='viewport'>
<meta content='1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0' name='google-site-verification'>
<meta content='#3681E4' property='msapplication-TileColor'>
<meta content='/favicon-144.png' property='msapplication-TileImage'>
<meta content='[{&quot;id&quot;:&quot;recaptcha_experiment&quot;,&quot;optimize_id&quot;:&quot;dpViOcLkT3qS4TvL2mRojA&quot;,&quot;title&quot;:&quot;No Recaptcha shown for trusted users&quot;,&quot;variant_index&quot;:0,&quot;variant&quot;:&quot;original&quot;}]' name='active-experiments'>
<meta content='{&quot;userId&quot;:11061062,&quot;experimentIds&quot;:[&quot;programs&quot;,&quot;chat_off_for_signed_out_users&quot;,&quot;course_upgrade&quot;,&quot;program_learning_assignment&quot;,&quot;perf_test&quot;,&quot;program_groups&quot;,&quot;teams&quot;,&quot;canonical_domain_redirect&quot;,&quot;program_resources&quot;,&quot;used_in&quot;,&quot;community_forum&quot;,&quot;enforce_codebuild_verdicts&quot;,&quot;peer_assignment&quot;,&quot;oauth_risc_shutoff&quot;,&quot;show_annual_purchase_now&quot;,&quot;alexandria_show_bundle_errors&quot;,&quot;search_updates&quot;]}' name='help-api-product-data'>
<meta content='{&quot;groupIds&quot;:[&quot;non_suadmins&quot;,&quot;students&quot;,&quot;non_organization&quot;,&quot;non_program&quot;]}' name='help-api-custom-data'>
<meta content='In this lab you will learn how to provision a complete Kubernetes cluster using Google Kubernetes Engine; deploy and manage Docker containers using kubectl; and break an application into microservices using Kubernetes’ Deployments and Services.' name='description'>
<meta content='Qwiklabs' name='author'>
<meta content='Orchestrating the Cloud with Kubernetes | Google Cloud Skills Boost for Partners' property='og:title'>
<meta content='website' property='og:type'>
<meta content='/favicon-144.png' property='og:image'>
<meta content='Qwiklabs' property='og:site_name'>
<meta content='In this lab you will learn how to provision a complete Kubernetes cluster using Google Kubernetes Engine; deploy and manage Docker containers using kubectl; and break an application into microservices using Kubernetes’ Deployments and Services.' property='og:description'>
<meta content='/qwiklabs_logo_900x887.png' property='og:logo' size='900x887'>
<meta content='/qwiklabs_logo_994x187.png' property='og:logo' size='994x187'>


<meta property="og:url" content="https://partner.cloudskillsboost.google/focuses/11556?parent=catalog" /><link href="https://partner.cloudskillsboost.google/focuses/11556?parent=catalog" rel="canonical" />
<link color='#3681E4' href='/favicon-svg.svg' rel='mask-icon'>
<link href='/favicon-180.png' rel='apple-touch-icon-precomposed'>
<link href='https://cdn.qwiklabs.com/Vag5GK2J6rS6843Qvg8TQJ1kEbAsEmQoF0%2BdLRfcLRE%3D' rel='shortcut icon' type='image/x-icon'>


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald:400|Roboto+Mono:400,700|Roboto:300,400,500,700|Google+Sans:300,400,500,700|Google+Sans+Display:400|Material+Icons|Google+Material+Icons" media="screen" />

<link rel="stylesheet" href="https://cdn.qwiklabs.com/assets/application-9c3b65b21d70e11e97ae9ab48dd150018a15c36cd951e52fe5574dfa177e8bc8.css" media="all" />


<style>
  :root {
    --primary-text-on-surface-color: #1a73e8;
    --primary-text-on-surface-color-dark: #1568d6;
    --primary-text-on-surface-color-darker: #135ec1;
    --primary-text-on-surface-color-darkest: #1154ac;
    --primary-surface-color: #1a73e8;
    --primary-surface-color-rgb: 26,115,232;
    --primary-surface-color-light: #d1e3fa;
    --primary-surface-color-lightest: #e8f1fd;
    --text-on-primary-color: #ffffff;
    --accent-text-on-surface-color: #f29900;
    --accent-surface-color: #f9ab00;
    --accent-surface-color-rgb: 249,171,0;
    --accent-surface-color-light: #ffefcc;
    --text-on-accent-color: #202124;
  }
</style>

<style>
  :root {
    --navbar-height: 112px;
  }
</style>



</head>
<body class='lab-show l-full no-nav application-new focuses focuses-show lab-show l-full no-nav '>
<div class='header-container'>
<div class='header'>
<ql-toolbar jumpEnabled>
<div class='header__title' slot='title'>
<ql-icon-button label="Back" href="https://partner.cloudskillsboost.google/quests/121" id="16aac3cabdd8bc18" target="_self" tip="Back">arrow_back</ql-icon-button>
<h1 class='ql-headline-6'>Orchestrating the Cloud with Kubernetes</h1>
</div>
<div class='header__actions' slot='action'>
<ql-icon-button icon='share' id='share_486' label='Share on social media' tip='Share'></ql-icon-button>
<ql-menu for='share_486'>
<ql-menu-item data-analytics-action='Shared to LinkedIn Feed.' data-analytics-category='Lab' data-analytics-label='Orchestrating the Cloud with Kubernetes' href='https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fpartner.cloudskillsboost.google%2Fcatalog_lab%2F486%3Futm_medium%3Dsocial%26utm_source%3Dlinkedin%26utm_campaign%3Dql-social-share' icon='post_linkedin' label='Share on LinkedIn Feed' role='link' target='_blank'>
<span class='label'>Share on LinkedIn Feed</span>
</ql-menu-item>

<ql-menu-item data-analytics-action='Shared to Twitter.' data-analytics-category='Lab' data-analytics-label='Orchestrating the Cloud with Kubernetes' href='https://twitter.com/intent/tweet?text=Learn%20cloud%20tech%20through%20hands-on%20training%20on%20%23Qwiklabs%21&amp;url=https%3A%2F%2Fpartner.cloudskillsboost.google%2Fcatalog_lab%2F486%3Futm_medium%3Dsocial%26utm_source%3Dtwitter%26utm_campaign%3Dql-social-share&amp;hashtags=' icon='post_twitter' label='Twitter' role='link' target='_blank'>
<span class='label'>Twitter</span>
</ql-menu-item>

<ql-menu-item data-analytics-action='Shared to Facebook.' data-analytics-category='Lab' data-analytics-label='Orchestrating the Cloud with Kubernetes' href='https://facebook.com/sharer.php?display=popup&amp;u=https%3A%2F%2Fpartner.cloudskillsboost.google%2Fcatalog_lab%2F486%3Futm_medium%3Dsocial%26utm_source%3Dfacebook%26utm_campaign%3Dql-social-share' icon='post_facebook' label='Facebook' role='link' target='_blank'>
<span class='label'>Facebook</span>
</ql-menu-item>

<ql-copyable-input label='Share Link' value='https://partner.cloudskillsboost.google/catalog_lab/486'></ql-copyable-input>
</ql-menu>

<ql-icon-button class='icon-button js-favorite-button favorite-button' data-id='11556' data-name='Orchestrating the Cloud with Kubernetes' data-type='CatalogItem' href='/favorite.json?item_id=11556&amp;item_type=CatalogItem' id='CatalogItem-11556-favorite-button' label='Add to favorites' tip='Add to favorites'>
favorite_border
</ql-icon-button>



<ql-icon-button id='control-panel-target' style='display: none;'>
dashboard
</ql-icon-button>
<ql-menu for='control-panel-target' id='control-panel-menu'></ql-menu>
<ql-icon-button class='mobile-hide' icon='help_outline' id='help-menu-button' label='Open help menu' tip='Help'></ql-icon-button>
<ql-menu for='help-menu-button' id='help-menu'>
<ql-menu-item data-analytics-action='opened_help' data-analytics-label='lab' label='Help Center' onclick='hallofmirrors.helpService.startHelp({&quot;productData&quot;:{&quot;userId&quot;:11061062},&quot;context&quot;:&quot;lab&quot;})'></ql-menu-item>
<ql-menu-item href='mailto:support@qwiklabs.com' label='Email support'></ql-menu-item>
<ql-menu-item label='Chat support' onClick='ql.chat.open()'></ql-menu-item>
</ql-menu>

<ql-icon-button class='mobile-hide' icon='language' id='language' label='Select your language preference' tip='Language'></ql-icon-button>
<ql-menu for='language'>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ar' href='/focuses/11556?locale=ar&amp;parent=catalog' label='العربية‬‎' lang='ar'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='de' href='/focuses/11556?locale=de&amp;parent=catalog' label='Deutsch' lang='de'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='en' href='/focuses/11556?locale=en&amp;parent=catalog' label='English' lang='en'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='es' href='/focuses/11556?locale=es&amp;parent=catalog' label='español (Latinoamérica)' lang='es'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='fr' href='/focuses/11556?locale=fr&amp;parent=catalog' label='français' lang='fr'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='fr_CA' href='/focuses/11556?locale=fr_CA&amp;parent=catalog' label='français (Canada)' lang='fr-CA'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='he' href='/focuses/11556?locale=he&amp;parent=catalog' label='עברית' lang='he'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='id' href='/focuses/11556?locale=id&amp;parent=catalog' label='bahasa Indonesia' lang='id'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='it' href='/focuses/11556?locale=it&amp;parent=catalog' label='Italiano' lang='it'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ja' href='/focuses/11556?locale=ja&amp;parent=catalog' label='日本語' lang='ja'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ko' href='/focuses/11556?locale=ko&amp;parent=catalog' label='한국어' lang='ko'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='pl' href='/focuses/11556?locale=pl&amp;parent=catalog' label='Polski' lang='pl'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='pt_BR' href='/focuses/11556?locale=pt_BR&amp;parent=catalog' label='português (Brasil)' lang='pt-BR'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='pt_PT' href='/focuses/11556?locale=pt_PT&amp;parent=catalog' label='português (Portugal)' lang='pt-PT'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ru' href='/focuses/11556?locale=ru&amp;parent=catalog' label='русский' lang='ru'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='tr' href='/focuses/11556?locale=tr&amp;parent=catalog' label='Türkçe' lang='tr'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='uk' href='/focuses/11556?locale=uk&amp;parent=catalog' label='український' lang='uk'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='zh' href='/focuses/11556?locale=zh&amp;parent=catalog' label='简体中文' lang='zh'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='zh_TW' href='/focuses/11556?locale=zh_TW&amp;parent=catalog' label='繁體中文' lang='zh-TW'></ql-menu-item>
</ql-menu>

<ql-icon-button id='my_account' label='My account' tip='My account'>
<ql-avatar></ql-avatar>
</ql-icon-button>
<ql-menu for='my_account' id='my_account_menu' style='max-height: 640px'>
<div class='my-account-menu'>
<ql-avatar class='l-mtl l-mbl' size='120'></ql-avatar>
<div class='my-account-menu__user-info l-mbl'>
<h4 class='ql-subhead-1'>Ausaf Khan</h4>
<p class='ql-body-2 text--light'>ausaf.khan@rakuten.com</p>
<p class='ql-body-2 text--light'>
</p>
<a class="text--green ql-subhead-2" href="/my_account/payments"><ql-chip positive>
0 Credits
</ql-chip>
</a></div>
<div class='buttons l-mbl'>
<a class="button button--hairline l-mrm" id="profile" href="/public_profiles/1d61c1a3-8a07-4495-8abe-b57e519718e6">Public Profile</a>
<a class="button button--hairline" id="settings" href="/my_account/profile">Settings</a>
</div>
<hr>
<ql-button data-analytics-action='clicked_sign_out' href='/users/sign_out' method='delete'>
Sign Out
</ql-button>
<div class='privacy l-mtl'>
<a target="_blank" class="ql-caption text--light" href="/privacy_policy">Privacy</a>
<span class='ql-caption text--light l-mls l-mrs'>&middot;</span>
<a class="ql-caption text--light" href="/terms_of_service">Terms</a>
</div>
</div>
</ql-menu>

</div>
</ql-toolbar>

</div>
</div>

<nav class='nav-panel js-nav-panel'>
<div class='nav-panel__logo'>
<div class="custom-logo"><img alt="Google Cloud Skills Boost for Partners" height="24" aria-label="Google Cloud Skills Boost for Partners" src="https://cdn.qwiklabs.com/PGyhmgS3zZncIEGywnx5UXsKwepRRFQ9BhAg%2FWHNrlQ%3D" /></div>
</div>
<nav class='ql-sidenav'>
<ql-sidenav-item href='/' icon='home' label='Paths'></ql-sidenav-item>

<ql-sidenav-item active href='/catalog' icon='school' label='Explore'></ql-sidenav-item>

<ql-sidenav-item href='/profile' icon='event_note' label='Profile'></ql-sidenav-item>

</nav>

</nav>
<div class='nav-panel__overlay js-nav-toggle'></div>

<main class='js-main' id='jump-content'>
<div class='l-main-wrapper' id='main-wrapper'>




<div class='lab-assessment__tab js-open-lab-assessment-panel'>
<button class='js-lab-assessment-total-score'>
—/100
</button>
</div>
<div aria-labelledby='lab-assessment-checkpoint' class='lab-assessment__panel js-lab-assessment-panel' role='dialog'>
<div class='lab-assessment__panel__header'>
<h4 id='lab-assessment-checkpoint'>Checkpoints</h4>
<ql-icon-button class='js-close-lab-assessment-panel' icon='arrow_forward' label='Close dialog'></ql-icon-button>
</div>
<div class='lab-assessment__step'>
<p class='lab-assessment__step__title' id='lab-assessment-step-title'>
Create a Kubernetes cluster and launch Nginx container
</p>
<div class='lab-assessment__step__action'>
<ql-button class='js-show-run-step-button' description='Create a Kubernetes cluster and launch Nginx container' step_no='1'>
Check my progress
</ql-button>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-1'>
</span>
/ 25
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title' id='lab-assessment-step-title'>
Create Monolith pods and service
</p>
<div class='lab-assessment__step__action'>
<ql-button class='js-show-run-step-button' description='Create Monolith pods and service' step_no='2'>
Check my progress
</ql-button>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-2'>
</span>
/ 25
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title' id='lab-assessment-step-title'>
Allow traffic to the monolith service on the exposed nodeport
</p>
<div class='lab-assessment__step__action'>
<ql-button class='js-show-run-step-button' description='Allow traffic to the monolith service on the exposed nodeport' step_no='3'>
Check my progress
</ql-button>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-3'>
</span>
/ 5
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title' id='lab-assessment-step-title'>
Adding Labels to Pods
</p>
<div class='lab-assessment__step__action'>
<ql-button class='js-show-run-step-button' description='Adding Labels to Pods' step_no='4'>
Check my progress
</ql-button>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-4'>
</span>
/ 20
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title' id='lab-assessment-step-title'>
Creating Deployments (Auth, Hello and Frontend)
</p>
<div class='lab-assessment__step__action'>
<ql-button class='js-show-run-step-button' description='Creating Deployments (Auth, Hello and Frontend)' step_no='5'>
Check my progress
</ql-button>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-5'>
</span>
/ 25
</p>
</div>
</div>

</div>
<ql-drawer-container class='js-lab-state' data-analytics-payload='{&quot;label&quot;:&quot;Orchestrating the Cloud with Kubernetes&quot;,&quot;lab_name&quot;:&quot;Orchestrating the Cloud with Kubernetes&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;googlecourses-run&quot;}' data-credits='0.0' data-focus-id='11556' data-lab-billing-limit='0.0' data-lab-duration='4500' data-parent='catalog' data-recaptcha-enabled id='lab-container'>
<ql-drawer id='terminal-drawer' slot='drawer' style='width: calc(100% - 480px)'>
<iframe allow='clipboard-read' class='terminal' id='embedded-resource'></iframe>
</ql-drawer>
<ql-drawer-content class='js-lab-wrapper' id='lab-content' slot='drawer-content'>
<ql-drawer-container id='lab-content-container'>
<ql-drawer id='control-panel-drawer' open slot='drawer' width='320'>
<ql-lab-control-panel class='ql-lab-control-panel__max-height control-panel js-lab-control-panel' connectionFiles='[]' labControlButton='{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}' labDetails='[]' labTimer='{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:4500}' studentResources='[]'>
<script src="https://www.recaptcha.net/recaptcha/api.js?render=6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr"   ></script>
        <script>
          // Define function so that we can call it again later if we need to reset it
          // This executes reCAPTCHA and then calls our callback.
          function executeRecaptchaForStartLab() {
            grecaptcha.ready(function() {
              grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}).then(function(token) {
                setInputWithRecaptchaResponseTokenForStartLab('g-recaptcha-response-data-start-lab', token)
              });
            });
          };
          // Invoke immediately
          executeRecaptchaForStartLab()

          // Async variant so you can await this function from another async function (no need for
          // an explicit callback function then!)
          // Returns a Promise that resolves with the response token.
          async function executeRecaptchaForStartLabAsync() {
            return new Promise((resolve, reject) => {
             grecaptcha.ready(async function() {
                resolve(await grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}))
              });
            })
          };

                    var setInputWithRecaptchaResponseTokenForStartLab = function(id, token) {
            var element = document.getElementById(id);
            element.value = token;
          }

        </script>
<input type="hidden" name="g-recaptcha-response-data[start_lab]" id="g-recaptcha-response-data-start-lab" data-sitekey="6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr" class="g-recaptcha g-recaptcha-response "/>

<div aria-live='polite' class='hidden' id='recaptcha-v2-start-lab' slot='recaptcha'>
<script src="https://www.recaptcha.net/recaptcha/api.js" async defer ></script>
<div data-sitekey="6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV" data-callback="recaptchaComplete" data-expired-callback="expireV2Token" class="g-recaptcha "></div>
          <noscript>
            <div>
              <div style="width: 302px; height: 422px; position: relative;">
                <div style="width: 302px; height: 422px; position: absolute;">
                  <iframe
                    src="https://www.recaptcha.net/recaptcha/api/fallback?k=6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV"
                    name="ReCAPTCHA"
                    style="width: 302px; height: 422px; border-style: none; border: 0; overflow: hidden;">
                  </iframe>
                </div>
              </div>
              <div style="width: 300px; height: 60px; border-style: none;
                bottom: 12px; left: 25px; margin: 0px; padding: 0px; right: 25px;
                background: #f9f9f9; border: 1px solid #c1c1c1; border-radius: 3px;">
                <textarea id="g-recaptcha-response" name="g-recaptcha-response"
                  class="g-recaptcha-response"
                  style="width: 250px; height: 40px; border: 1px solid #c1c1c1;
                  margin: 10px 25px; padding: 0px; resize: none;">
                </textarea>
              </div>
            </div>
          </noscript>

</div>
</ql-lab-control-panel>
</ql-drawer>
<ql-drawer-content id='lab-instructions' slot='drawer-content'>
<ql-snackbar id='alert-snackbar'></ql-snackbar>
<div class='alert alert--fake js-alert'>
<p class='alert__message js-alert-message' role='alert'></p>
<ql-icon-button class='alert__close js-alert-close' icon='clear'></ql-icon-button>
<iframe class='l-ie-iframe-fix' tabindex='-1'></iframe>
</div>
<div class='lab-content__renderable-instructions js-lab-content'>
<div class='lab-preamble'>
<h1 class='lab-preamble__title'>
Orchestrating the Cloud with Kubernetes
</h1>
<div class='lab-preamble__details subtitle-headline-1'>
<span>1 hour 15 minutes</span>
<span>Free</span>
<div class='lab__rating'>
<a aria-label="Lab Reviews" href="/focuses/11556/reviews?parent=catalog"><div class='rateit' data-rateit-readonly='true' data-rateit-value='4.6399'></div>

</a><ql-button aria-label='Rate Lab' id='rate-lab-btn' label='Rate Lab' text></ql-button>
</div>
</div>
</div>
<div class='lab-outline-place-holder'></div>

<div class='markdown-lab-instructions js-markdown-instructions' id='markdown-lab-instructions'>

<h2 id="step1">GSP021</h2>
<p><img alt="Google Cloud self-paced labs logo" src="https://cdn.qwiklabs.com/GMOHykaqmlTHiqEeQXTySaMXYPHeIvaqa2qHEzw6Occ%3D"></p>
<h2 id="step2">Overview</h2>
<p>In this lab you will learn how to:</p>
<ul>
<li>Provision a complete  <a href="http://kubernetes.io" target="_blank">Kubernetes</a> cluster using  <a href="https://cloud.google.com/container-engine" target="_blank">Kubernetes Engine</a>.</li>
<li>Deploy and manage Docker containers using <code>kubectl</code>.</li>
<li>Break an application into microservices using Kubernetes' Deployments and Services.</li>
</ul>
<p>Kubernetes is all about applications. In this part of the lab you will use an example application called "app".</p>
<ql-infobox><strong>Note: </strong><a href="https://github.com/kelseyhightower/app" target="blank">App</a> is hosted on GitHub and provides an example 12-Factor application. During this lab you will be working with the following Docker images:
<li>
<a href="https://hub.docker.com/r/kelseyhightower/monolith" target="blank">kelseyhightower/monolith</a> - Monolith includes auth and hello services.</li>
<li>
<a href="https://hub.docker.com/r/kelseyhightower/auth" target="blank">kelseyhightower/auth</a> - Auth microservice. Generates JWT tokens for authenticated users.</li>
<li>
<a href="https://hub.docker.com/r/kelseyhightower/hello" target="blank">kelseyhightower/hello</a> - Hello microservice. Greets authenticated users.</li>
<li>
<a href="https://hub.docker.com/_/nginx" target="blank">nginx</a> - Frontend to the auth and hello services.
</li></ql-infobox>
<p>Kubernetes is an open source project (available on <a href="http://kubernetes.io/" target="_blank">kubernetes.io</a>) which can run on many different environments, from laptops to high-availability multi-node clusters, from public clouds to on-premise deployments, from virtual machines to bare metal.</p>
<p>For this lab, using a managed environment such as Kubernetes Engine allows you to focus on experiencing Kubernetes rather than setting up the underlying infrastructure.</p>
<h2 id="step3">Setup and requirements</h2>
<h3>Before you click the Start Lab button</h3>
<p>Read these instructions. Labs are timed and you cannot pause them. The timer, which starts when you click <strong>Start Lab</strong>, shows how long Google Cloud resources will be made available to you.</p>
<p>This hands-on lab lets you do the lab activities yourself in a real cloud environment, not in a simulation or demo environment. It does so by giving you new, temporary credentials that you use to sign in and access Google Cloud for the duration of the lab.</p>
<p>To complete this lab, you need:</p>
<ul>
<li>Access to a standard internet browser (Chrome browser recommended).</li>
</ul>
<ql-warningbox>
<strong>Note:</strong> Use an Incognito or private browser window to run this lab. This prevents any conflicts between your personal account and the Student account, which may cause extra charges incurred to your personal account.
</ql-warningbox>
<ul>
<li>Time to complete the lab---remember, once you start, you cannot pause a lab.</li>
</ul>
<ql-warningbox>
<strong>Note:</strong> If you already have your own personal Google Cloud account or project, do not use it for this lab to avoid extra charges to your account.
</ql-warningbox>
<h3>How to start your lab and sign in to the Google Cloud Console</h3>
<ol>
<li>
<p>Click the <strong>Start Lab</strong> button. If you need to pay for the lab, a pop-up opens for you to select your payment method.
On the left is the <strong>Lab Details</strong> panel with the following:</p>
<ul>
<li>The <strong>Open Google Console</strong> button</li>
<li>Time remaining</li>
<li>The temporary credentials that you must use for this lab</li>
<li>Other information, if needed, to step through this lab</li>
</ul>
</li>
<li>
<p>Click <strong>Open Google Console</strong>.
The lab spins up resources, and then opens another tab that shows the <strong>Sign in</strong> page.</p>
<p><strong><em>Tip:</em></strong> Arrange the tabs in separate windows, side-by-side.</p>
<ql-infobox>
<strong>Note: </strong>If you see the <strong>Choose an account</strong> dialog, click <strong>Use Another Account</strong>.        
 </ql-infobox>
</li>
<li>
<p>If necessary, copy the <strong>Username</strong> from the <strong>Lab Details</strong> panel and paste it into the <strong>Sign in</strong> dialog. Click <strong>Next</strong>.</p>
</li>
<li>
<p>Copy the <strong>Password</strong> from the <strong>Lab Details</strong> panel and paste it into the <strong>Welcome</strong> dialog. Click <strong>Next</strong>.</p>
<ql-infobox>
<strong>Important: </strong>You must use the credentials from the left panel. Do not use your Google Cloud Skills Boost credentials. 
 </ql-infobox>
<ql-warningbox>
<strong>Note: </strong>Using your own Google Cloud account for this lab may incur extra charges.
 </ql-warningbox>
</li>
<li>
<p>Click through the subsequent pages:</p>
<ul>
<li>Accept the terms and conditions.</li>
<li>Do not add recovery options or two-factor authentication (because this is a temporary account).</li>
<li>Do not sign up for free trials.</li>
</ul>
</li>
</ol>
<p>After a few moments, the Cloud Console opens in this tab.</p>
<ql-infobox>
<strong>Note:</strong> You can view the menu with a list of Google Cloud Products and Services by clicking the <strong>Navigation menu</strong> at the top-left.
<img alt="Navigation menu icon" src="https://cdn.qwiklabs.com/nUxFb6oRFr435O3t6V7WYJAjeDFcrFb16G9wHWp5BzU%3D">
</ql-infobox>
<h3>Activate Cloud Shell</h3>
<p>Cloud Shell is a virtual machine that is loaded with development tools. It offers a persistent 5GB home directory and runs on the Google Cloud. Cloud Shell provides command-line access to your Google Cloud resources.</p>
<ol>
<li>Click <strong>Activate Cloud Shell</strong> <img alt="Activate Cloud Shell icon" src="https://cdn.qwiklabs.com/ep8HmqYGdD%2FkUncAAYpV47OYoHwC8%2Bg0WK%2F8sidHquE%3D"> at the top of the Google Cloud console.</li>
</ol>
<p>When you are connected, you are already authenticated, and the project is set to your <strong>PROJECT_ID</strong>. The output contains a line that declares the <strong>PROJECT_ID</strong> for this session:</p>
<ql-code-block output="">
Your Cloud Platform project in this session is set to YOUR_PROJECT_ID
</ql-code-block>
<p><code>gcloud</code> is the command-line tool for Google Cloud. It comes pre-installed on Cloud Shell and supports tab-completion.</p>
<ol start="2">
<li>
<p>(Optional) You can list the active account name with this command:</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud auth list
</ql-code-block>
<ol start="3">
<li>
<p>Click <strong>Authorize</strong>.</p>
</li>
<li>
<p>Your output should now look like this:</p>
</li>
</ol>
<p><strong>Output:</strong></p>
<ql-code-block language="plaintext" output="">
ACTIVE: *
ACCOUNT: student-01-xxxxxxxxxxxx@qwiklabs.net
To set the active account, run:
    $ gcloud config set account `ACCOUNT`
</ql-code-block>
<ol start="5">
<li>
<p>(Optional) You can list the project ID with this command:</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud config list project
</ql-code-block>
<p><strong>Output:</strong></p>
<ql-code-block language="plaintext" output="">
[core]
project = &lt;project_ID&gt;
</ql-code-block>
<p><strong>Example output:</strong></p>
<ql-code-block language="plaintext" output="">
[core]
project = qwiklabs-gcp-44776a13dea667a6
</ql-code-block>
<ql-infobox>
<strong>Note: </strong>For full documentation of <code>gcloud</code>, in Google Cloud, refer to <a href="https://cloud.google.com/sdk/gcloud" target="_blank">the gcloud CLI overview guide</a>.
</ql-infobox>
<h3><strong>Google Kubernetes Engine</strong></h3>
<ol>
<li>
<p>In the cloud shell environment type the following command to set the zone:</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud config set compute/zone us-central1-b
</ql-code-block>
<ol start="2">
<li>
<p>Start up a cluster for use in this lab:</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud container clusters create io
</ql-code-block>
<ql-infobox>
You are automatically authenticated to your cluster upon creation. If you lose connection to your Cloud Shell for any reason, run the <code>gcloud container clusters get-credentials io</code> command to re-authenticate.
</ql-infobox>
<ql-infobox>
<strong>Note: </strong> It will take a while to create a cluster - Kubernetes Engine is provisioning a few Virtual Machines behind the scenes for you to play with!
</ql-infobox>
<h2 id="step4">Task 1. Get the sample code</h2>
<ol>
<li>
<p>Copy the source code from the Cloud Shell command line:</p>
</li>
</ol>
<ql-code-block language="plaintext">
gsutil cp -r gs://spls/gsp021/* .
</ql-code-block>
<ol start="2">
<li>
<p>Change into the directory needed for this lab:</p>
</li>
</ol>
<ql-code-block language="plaintext">
cd orchestrate-with-kubernetes/kubernetes
</ql-code-block>
<ol start="3">
<li>
<p>List the files to see what you're working with:</p>
</li>
</ol>
<ql-code-block language="plaintext">
ls
</ql-code-block>
<p>The sample has the following layout:</p>
<ql-code-block language="plaintext" output="">
deployments/  /* Deployment manifests */
  ...
nginx/        /* nginx config files */
  ...
pods/         /* Pod manifests */
  ...
services/     /* Services manifests */
  ...
tls/          /* TLS certificates */
  ...
cleanup.sh    /* Cleanup script */
</ql-code-block>
<p>Now that you have the code -- it's time to give Kubernetes a try!</p>
<h2 id="step5">Task 2. Quick Kubernetes Demo</h2>
<p>The easiest way to get started with Kubernetes is to use the <code>kubectl create</code> command.</p>
<ol>
<li>
<p>Use it to launch a single instance of the nginx container:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create deployment nginx --image=nginx:1.10.0
</ql-code-block>
<p>Kubernetes has created a deployment -- more about deployments later, but for now all you need to know is that deployments keep the pods up and running even when the nodes they run on fail.</p>
<p>In Kubernetes, all containers run in a pod.</p>
<ol start="2">
<li>
<p>Use the <code>kubectl get pods</code> command to view the  running nginx container:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl get pods
</ql-code-block>
<ol start="3">
<li>
<p>Once the nginx container has a Running status you can expose it outside of Kubernetes using the <code>kubectl expose</code> command:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl expose deployment nginx --port 80 --type LoadBalancer
</ql-code-block>
<p>So what just happened? Behind the scenes Kubernetes created an external Load Balancer with a public IP address attached to it. Any client who hits that public IP address will be routed to the pods behind the service. In this case that would be the nginx pod.</p>
<ol start="4">
<li>
<p>List our services now using the <code>kubectl get services</code> command:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl get services
</ql-code-block>
<ql-infobox>
<strong>Note:</strong> It may take a few seconds before the <code>ExternalIP</code> field is populated for your service. This is normal -- just re-run the <code>kubectl get services</code> command every few seconds until the field populates.
</ql-infobox>
<ol start="5">
<li>
<p>Add the External IP to this command to hit the Nginx container remotely:</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl http://&lt;External IP&gt;:80
</ql-code-block>
<p>And there you go! Kubernetes supports an easy to use workflow out of the box using the <code>kubectl</code> run and expose commands.</p>
<h3>Test completed task</h3>
<p>Click <strong>Check my progress</strong> below to check your lab progress. If you successfully created a Kubernetes cluster and deploy a Nginx container, you'll see an assessment score.</p>
<ql-activity-tracking step="1">
    Create a Kubernetes cluster and launch Nginx container
</ql-activity-tracking>
<p>Now that you've seen a quick tour of kubernetes, it's time to dive into each of the components and abstractions.</p>
<h2 id="step6">Task 3. Pods</h2>
<p>At the core of Kubernetes is the  <a href="https://kubernetes.io/docs/concepts/workloads/pods/" target="_blank">Pod</a>.</p>
<p>Pods represent and hold a collection of one or more containers. Generally, if you have multiple containers with a hard dependency on each other, you package the containers inside a single pod.</p>
<p><img alt="Pod containing the monolith and nginx containers" src="https://cdn.qwiklabs.com/tzvM5wFnfARnONAXX96nz8OgqOa1ihx6kCk%2BelMakfw%3D"></p>
<p>In this example there is a pod that contains the monolith and nginx containers.</p>
<p>Pods also have  <a href="https://kubernetes.io/docs/concepts/storage/volumes/" target="_blank">Volumes</a>. Volumes are data disks that live as long as the pods live, and can be used by the containers in that pod. Pods provide a shared namespace for their contents which means that the two containers inside of our example pod can communicate with each other, and they also share the attached volumes.</p>
<p>Pods also share a network namespace. This means that there is one IP Address per pod.</p>
<p>Next, a deeper dive into pods.</p>
<h2 id="step7">Task 4. Creating pods</h2>
<p>Pods can be created using pod configuration files. Take a moment to explore the monolith pod configuration file.</p>
<ol>
<li>
<p>Go to directory:</p>
</li>
</ol>
<ql-code-block language="plaintext">
cd ~/orchestrate-with-kubernetes/kubernetes
</ql-code-block>
<ol start="2">
<li>
<p>Run the following:</p>
</li>
</ol>
<ql-code-block language="plaintext">
cat pods/monolith.yaml
</ql-code-block>
<p>The output shows the open configuration file:</p>
<ql-code-block language="plaintext" output="">
apiVersion: v1
kind: Pod
metadata:
  name: monolith
  labels:
    app: monolith
spec:
  containers:
    - name: monolith
      image: kelseyhightower/monolith:1.0.0
      args:
        - "-http=0.0.0.0:80"
        - "-health=0.0.0.0:81"
        - "-secret=secret"
      ports:
        - name: http
          containerPort: 80
        - name: health
          containerPort: 81
      resources:
        limits:
          cpu: 0.2
          memory: "10Mi"
</ql-code-block>
<p>There's a few things to notice here. You'll see that:</p>
<ul>
<li>
<p>Your pod is made up of one container (the monolith).</p>
</li>
<li>
<p>You're passing a few arguments to our container when it starts up.</p>
</li>
<li>
<p>You're opening up port 80 for http traffic.</p>
</li>
</ul>
<ol start="3">
<li>
<p>Create the monolith pod using <code>kubectl</code>:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create -f pods/monolith.yaml
</ql-code-block>
<ol start="4">
<li>
<p>Examine your pods. Use the <code>kubectl get pods</code> command to list all pods running in the default namespace:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl get pods
</ql-code-block>
<ql-infobox>
<strong>Note:</strong> It may take a few seconds before the monolith pod is up and running. The monolith container image needs to be pulled from the Docker Hub before you can run it.
</ql-infobox>
<ol start="5">
<li>
<p>Once the pod is running, use <code>kubectl describe</code> command to get more information about the monolith pod:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl describe pods monolith
</ql-code-block>
<p>You'll see a lot of the information about the monolith pod including the Pod IP address and the event log. This information will come in handy when troubleshooting.</p>
<p>Kubernetes makes it easy to create pods by describing them in configuration files and easy to view information about them when they are running. At this point you have the ability to create all the pods your deployment requires!</p>
<h2 id="step8">Task 5. Interacting with pods</h2>
<p>By default, pods are allocated a private IP address and cannot be reached outside of the cluster. Use the <code>kubectl port-forward</code> command to map a local port to a port inside the monolith pod.</p>
<ql-infobox><strong>Note: </strong>From this point on the lab will ask you to work in multiple cloud shell tabs to set up communication between the pods. Any commands that are executed in a second or third command shell will be denoted in the command's instructions.
</ql-infobox>
<ol>
<li>
<p>Open a second Cloud Shell terminal. Now you have two terminals, one to run the <code>kubectl port-forward</code> command, and the other to issue <code>curl</code> commands.</p>
</li>
<li>
<p>In the <strong>2nd terminal</strong>, run this command to set up port-forwarding:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl port-forward monolith 10080:80
</ql-code-block>
<ol start="3">
<li>
<p>Now in the <strong>1st terminal</strong> start talking to your pod using <code>curl</code>:</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl http://127.0.0.1:10080
</ql-code-block>
<p>Yes!  You got a very friendly "hello" back from your container.</p>
<ol start="4">
<li>
<p>Now use the <code>curl</code> command to see what happens when you hit a secure endpoint:</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl http://127.0.0.1:10080/secure
</ql-code-block>
<p>Uh oh.</p>
<ol start="5">
<li>
<p>Try logging in to get an auth token back from the monolith:</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl -u user http://127.0.0.1:10080/login
</ql-code-block>
<ol start="6">
<li>At the login prompt, use the super-secret password "password" to login.</li>
</ol>
<p>Logging in caused a JWT token to print out.</p>
<ol start="7">
<li>
<p>Since Cloud Shell does not handle copying long strings well, create an environment variable for the token.</p>
</li>
</ol>
<ql-code-block language="plaintext">
TOKEN=$(curl http://127.0.0.1:10080/login -u user|jq -r '.token')
</ql-code-block>
<ol start="8">
<li>
<p>Enter the super-secret password "password" again when prompted for the host password.</p>
</li>
<li>
<p>Use this command to copy and then use the token to hit the secure endpoint with <code>curl</code>:</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl -H "Authorization: Bearer $TOKEN" http://127.0.0.1:10080/secure
</ql-code-block>
<p>At this point you should get a response back from our application, letting us know everything is right in the world again.</p>
<ol start="10">
<li>
<p>Use the <code>kubectl logs</code> command to view the logs for the <code>monolith</code> Pod.</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl logs monolith
</ql-code-block>
<ol start="11">
<li>
<p><strong>Open a 3rd terminal</strong> and use the <code>-f</code> flag to get a stream of the logs happening in real-time:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl logs -f monolith
</ql-code-block>
<ol start="12">
<li>
<p>Now if you use <code>curl</code> in the <strong>1st terminal</strong> to interact with the monolith, you can see the logs updating (in the <strong>3rd terminal</strong>):</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl http://127.0.0.1:10080
</ql-code-block>
<ol start="13">
<li>
<p>Use the <code>kubectl exec</code> command to run an interactive shell inside the Monolith Pod. This can come in handy when you want to troubleshoot from within a container:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl exec monolith --stdin --tty -c monolith -- /bin/sh
</ql-code-block>
<ol start="14">
<li>
<p>For example, once you have a shell into the monolith container you can test external connectivity using the <code>ping</code> command:</p>
</li>
</ol>
<ql-code-block language="plaintext">
ping -c 3 google.com
</ql-code-block>
<ol start="15">
<li>
<p>Be sure to log out when you're done with this interactive shell.</p>
</li>
</ol>
<ql-code-block language="plaintext">
exit
</ql-code-block>
<p>As you can see, interacting with pods is as easy as using the <code>kubectl</code> command. If you need to hit a container remotely, or get a login shell, Kubernetes provides everything you need to get up and going.</p>
<h2 id="step9">Task 6. Services</h2>
<p>Pods aren't meant to be persistent. They can be stopped or started for many reasons - like failed liveness or readiness checks - and this leads to a problem:</p>
<p>What happens if you want to communicate with a set of Pods? When they get restarted they might have a different IP address.</p>
<p>That's where  <a href="https://kubernetes.io/docs/concepts/services-networking/service/" target="_blank">Services</a> come in. Services provide stable endpoints for Pods.</p>
<p><img alt="Service network diagram" src="https://cdn.qwiklabs.com/Jg0T%2F326ASwqeD1vAUPBWH5w1D%2F0oZn6z5mQ5MubwL8%3D"></p>
<p>Services use labels to determine what Pods they operate on. If Pods have the correct labels, they are automatically picked up and exposed by our services.</p>
<p>The level of access a service provides to a set of pods depends on the Service's type. Currently there are three types:</p>
<ul>
<li>
<code>ClusterIP</code> (internal) -- the default type means that this Service is only visible inside of the cluster,</li>
<li>
<code>NodePort</code> gives each node in the cluster an externally accessible IP and</li>
<li>
<code>LoadBalancer</code> adds a load balancer from the cloud provider which forwards traffic from the service to Nodes within it.</li>
</ul>
<p>Now you'll learn how to:</p>
<ul>
<li>
<p>Create a service</p>
</li>
<li>
<p>Use label selectors to expose a limited set of Pods externally</p>
</li>
</ul>
<h2 id="step10">Task 7. Creating a service</h2>
<p>Before you can create our services, first create a secure pod that can handle https traffic.</p>
<ol>
<li>
<p>If you've changed directories, make sure you return to the <code>~/orchestrate-with-kubernetes/kubernetes</code> directory:</p>
</li>
</ol>
<ql-code-block language="plaintext">
cd ~/orchestrate-with-kubernetes/kubernetes
</ql-code-block>
<ol start="2">
<li>
<p>Explore the monolith service configuration file:</p>
</li>
</ol>
<ql-code-block language="plaintext">
cat pods/secure-monolith.yaml
</ql-code-block>
<ol start="3">
<li>
<p>Create the secure-monolith pods and their configuration data:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create secret generic tls-certs --from-file tls/
kubectl create configmap nginx-proxy-conf --from-file nginx/proxy.conf
kubectl create -f pods/secure-monolith.yaml
</ql-code-block>
<p>Now that you have a secure pod, it's time to expose the secure-monolith Pod externally.To do that, create a Kubernetes service.</p>
<ol start="4">
<li>
<p>Explore the monolith service configuration file:</p>
</li>
</ol>
<ql-code-block language="plaintext">
cat services/monolith.yaml
</ql-code-block>
<p>(Output):</p>
<ql-code-block language="plaintext" output="">
kind: Service
apiVersion: v1
metadata:
  name: "monolith"
spec:
  selector:
    app: "monolith"
    secure: "enabled"
  ports:
    - protocol: "TCP"
      port: 443
      targetPort: 443
      nodePort: 31000
  type: NodePort
</ql-code-block>
<ql-infobox>
<strong> Things to note:</strong>
<p>* There's a selector which is used to automatically find and expose any pods with the labels `app: monolith` and `secure: enabled`.</p>
<p>* Now you have to expose the nodeport here because this is how you'll forward external traffic from port 31000 to nginx (on port 443).</p>
</ql-infobox>
<ol start="5">
<li>
<p>Use the <code>kubectl create</code> command to create the monolith service from the monolith service configuration file:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create -f services/monolith.yaml
</ql-code-block>
<p>(Output):</p>
<ql-code-block language="plaintext" output="">
service/monolith created
</ql-code-block>
<h3>Test completed task</h3>
<p>Click <strong>Check my progress</strong> below to check your lab progress. If you successfully created Monolith pods and service, you'll see an assessment score.</p>
<ql-activity-tracking step="2">
    Create Monolith pods and service
</ql-activity-tracking>
<p>You're using a port to expose the service. This means that it's possible to have port collisions if another app tries to bind to port 31000 on one of your servers.</p>
<p>Normally, Kubernetes would handle this port assignment. In this lab you chose a port so that it's easier to configure health checks later on.</p>
<ol start="6">
<li>
<p>Use the <code>gcloud compute firewall-rules</code> command to allow traffic to the monolith service on the exposed nodeport:</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud compute firewall-rules create allow-monolith-nodeport \
  --allow=tcp:31000
</ql-code-block>
<h3>Test completed task</h3>
<p>Click <strong>Check my progress</strong> below to check your lab progress. If you successfully created a firewall rule to allow TCP traffic on the 31000 port, you'll see an assessment score.</p>
<ql-activity-tracking step="3">
    Allow traffic to the monolith service on the exposed nodeport
</ql-activity-tracking>
<p>Now that everything is set up you should be able to hit the secure-monolith service from outside the cluster without using port forwarding.</p>
<ol>
<li>
<p>First, get an external IP address for one of the nodes.</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud compute instances list
</ql-code-block>
<ol start="2">
<li>
<p>Now try hitting the secure-monolith service using <code>curl</code>:</p>
</li>
</ol>
<ql-code-block language="plaintext">
curl -k https://&lt;EXTERNAL_IP&gt;:31000
</ql-code-block>
<p>Uh oh!  That timed out.  What's going wrong?</p>
<ql-infobox><p><strong>Note: </strong>It's time for a quick knowledge check.</p>Use the following commands to answer the questions below:
<p><code>kubectl get services monolith</code></p>
<p><code>kubectl describe services monolith</code></p>
<p><strong>Questions:</strong></p>
<li>Why are you unable to get a response from the monolith service?
</li>
<li>How many endpoints does the monolith service have?
</li>
<li>What labels must a Pod have to be picked up by the monolith service?
</li></ql-infobox>
<p>Hint: it has to do with labels. You'll fix the issue in the next section.</p>
<h2 id="step11">Task 8. Adding labels to pods</h2>
<p>Currently the monolith service does not have endpoints. One way to troubleshoot an issue like this is to use the <code>kubectl get pods</code> command with a label query.</p>
<ol>
<li>
<p>You can see that you have quite a few pods running with the monolith label.</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl get pods -l "app=monolith"
</ql-code-block>
<ol start="2">
<li>
<p>But what about "app=monolith" and "secure=enabled"?</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl get pods -l "app=monolith,secure=enabled"
</ql-code-block>
<p>Notice this label query does not print any results. It seems like you need to add the "secure=enabled" label to them.</p>
<ol start="3">
<li>
<p>Use the <code>kubectl label</code> command to add the missing <code>secure=enabled</code> label to the secure-monolith Pod.  Afterwards, you can check and see that your labels have been updated.</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl label pods secure-monolith 'secure=enabled'
kubectl get pods secure-monolith --show-labels
</ql-code-block>
<ol start="4">
<li>
<p>Now that your pods are correctly labeled, view the list of endpoints on the monolith service:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl describe services monolith | grep Endpoints
</ql-code-block>
<p>And you have one!</p>
<ol start="5">
<li>
<p>Test this out by hitting one of our nodes again.</p>
</li>
</ol>
<ql-code-block language="plaintext">
gcloud compute instances list
curl -k https://&lt;EXTERNAL_IP&gt;:31000
</ql-code-block>
<p>Bam!  Houston, we have contact.</p>
<h3>Test completed task</h3>
<p>Click <strong>Check my progress</strong> below to check your lab progress. If you successfully added labels to monolith pods, you'll see an assessment score.</p>
<ql-activity-tracking step="4">
    Adding Labels to Pods
</ql-activity-tracking>
<h2 id="step12">Task 9. Deploying applications with Kubernetes</h2>
<p>The goal of this lab is to get you ready for scaling and managing containers in production. That's where  <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#what-is-a-deployment" target="_blank">Deployments</a> come in. Deployments are a declarative way to ensure that the number of Pods running is equal to the desired number of Pods, specified by the user.</p>
<p><img alt="Deployments diagram includes nodes one, two, and three. app: hello. replicas: 3" src="https://cdn.qwiklabs.com/1UD7MTP0ZxwecE%2F64MJSNOP8QB7sU9rTI0PSv08OVz0%3D">The main benefit of Deployments is in abstracting away the low level details of managing Pods.  Behind the scenes Deployments use  <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/" target="_blank">Replica Sets</a> to manage starting and stopping the Pods. If Pods need to be updated or scaled, the Deployment will handle that. Deployment also handles restarting Pods if they happen to go down for some reason.</p>
<p>Look at a quick example:</p>
<p><img alt="Deployments diagram" src="https://cdn.qwiklabs.com/fH4ZxGNxg5KLBy5ykbwKNIS9MIJ9cgcMEDuhB0a9uBo%3D"></p>
<p>Pods are tied to the lifetime of the Node they are created on. In the example above, Node3 went down (taking a Pod with it). Instead of manually creating a new Pod and finding a Node for it, your Deployment created a new Pod and started it on Node2.</p>
<p>That's pretty cool!</p>
<p>It's time to combine everything you learned about Pods and Services to break up the monolith application into smaller Services using Deployments.</p>
<h2 id="step13">Task 10. Creating deployments</h2>
<p>You're going to break the monolith app into three separate pieces:</p>
<ul>
<li>
<strong>auth</strong> - Generates JWT tokens for authenticated users.</li>
<li>
<strong>hello</strong> - Greet authenticated users.</li>
<li>
<strong>frontend</strong> - Routes traffic to the auth and hello services.</li>
</ul>
<p>You are ready to create deployments, one for each service.  Afterwards, you'll define internal services for the auth and hello deployments and an external service for the frontend deployment. Once finished you'll be able to interact with the microservices just like with Monolith only now each piece will be able to be scaled and deployed, independently!</p>
<ol>
<li>
<p>Get started by examining the auth deployment configuration file.</p>
</li>
</ol>
<ql-code-block language="plaintext">
cat deployments/auth.yaml
</ql-code-block>
<p>(Output)</p>
<ql-code-block language="plaintext" output="">
apiVersion: apps/v1
kind: Deployment
metadata:
  name: auth
spec:
  selector:
    matchlabels:
      app: auth
  replicas: 1
  template:
    metadata:
      labels:
        app: auth
        track: stable
    spec:
      containers:
        - name: auth
          image: "kelseyhightower/auth:2.0.0"
          ports:
            - name: http
              containerPort: 80
            - name: health
              containerPort: 81
...
</ql-code-block>
<p>The deployment is creating 1 replica, and you're using version 2.0.0 of the auth container.</p>
<p>When you run the <code>kubectl create</code> command to create the auth deployment it will make one pod that conforms to the data in the Deployment manifest. This means you can scale the number of Pods by changing the number specified in the Replicas field.</p>
<ol start="2">
<li>
<p>Anyway, go ahead and create your deployment object:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create -f deployments/auth.yaml
</ql-code-block>
<ol start="3">
<li>
<p>It's time to create a service for your auth deployment. Use the <code>kubectl create</code> command to create the auth service:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create -f services/auth.yaml
</ql-code-block>
<ol start="4">
<li>
<p>Now do the same thing to create and expose the hello deployment:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create -f deployments/hello.yaml
kubectl create -f services/hello.yaml
</ql-code-block>
<ol start="5">
<li>
<p>And one more time to create and expose the frontend Deployment.</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl create configmap nginx-frontend-conf --from-file=nginx/frontend.conf
kubectl create -f deployments/frontend.yaml
kubectl create -f services/frontend.yaml
</ql-code-block>
<ql-infobox><strong>Note: </strong>
There is one more step to creating the frontend because you need to store some configuration data with the container.
</ql-infobox>
<ol start="6">
<li>
<p>Interact with the frontend by grabbing its External IP and then curling to it:</p>
</li>
</ol>
<ql-code-block language="plaintext">
kubectl get services frontend
</ql-code-block>
<ql-infobox><strong>Note: </strong>It might take a minute for the external IP address to be generated. Run the above command again if the <code>EXTERNAL-IP</code> column status is pending.</ql-infobox>
<ql-code-block language="plaintext">
curl -k https://&lt;EXTERNAL-IP&gt;
</ql-code-block>
<p>And you get a hello response back!</p>
<h3>Test completed task</h3>
<p>Click <strong>Check my progress</strong> below to check your lab progress. If you successfully created Auth, Hello and Frontend deployments, you'll see an assessment score.</p>
<ql-activity-tracking step="5">
    Creating Deployments (Auth, Hello and Frontend)
</ql-activity-tracking>
<h2 id="step14">Congratulations!</h2>
<p>You've developed a multi-service application using Kubernetes. The skills you've learned here will allow you to deploy complex applications on Kubernetes using a collection of deployments and services.</p>
<h3>Finish your quest</h3>
<p>This self-paced lab is part of the <a href="https://google.qwiklabs.com/quests/24" target="_blank">Cloud Architecture</a> and <a href="https://google.qwiklabs.com/quests/29" target="_blank">Kubernetes in Google Cloud</a> quests. A quest is a series of related labs that form a learning path. Completing this quest earns you a badge to recognize your achievement. You can make your badge or badges public and link to them in your online resume or social media account. Enroll in any quest that contains this lab and get immediate completion credit.  See the <a href="http://cloudskillsboost.google/catalog" target="_blank">Google Cloud Skills Boost catalog</a> to see all available quests.</p>
<h3>Take your next lab</h3>
<p>Continue your quest with one of the following labs:</p>
<ul>
<li>
<p><a href="https://google.qwiklabs.com/catalog_lab/744" target="_blank">Continuous Delivery Pipelines with Spinnaker and Kubernetes Engine</a></p>
</li>
<li>
<p><a href="https://google.qwiklabs.com/catalog_lab/572" target="_blank">Managing Deployments Using Kubernetes Engine</a></p>
</li>
</ul>
<h3>Next steps / Learn more</h3>
<ul>
<li>You can follow the Kubernetes news on  <a href="https://twitter.com/kubernetesio" target="_blank">Twitter</a> and on the  <a href="http://blog.kubernetes.io/" target="_blank">community's blog</a>.</li>
<li>Remember, Kubernetes is an open source project ( <a href="http://kubernetes.io/" target="_blank">http://kubernetes.io/</a>) hosted on  <a href="https://github.com/kubernetes/kubernetes" target="_blank">GitHub</a>. Your feedback and contributions are always welcome.</li>
</ul>
<h3>Google Cloud training and certification</h3>
<p>...helps you make the most of Google Cloud technologies. <a href="https://cloud.google.com/training/courses" target="_blank">Our classes</a> include technical skills and best practices to help you get up to speed quickly and continue your learning journey. We offer fundamental to advanced level training, with on-demand, live, and virtual options to suit your busy schedule. <a href="https://cloud.google.com/certification/" target="_blank">Certifications</a> help you validate and prove your skill and expertise in Google Cloud technologies.</p>
<p><strong>Manual Last Updated June 22, 2023</strong></p>
<p><strong>Lab Last Tested June 22, 2023</strong></p>
<p>Copyright 2023 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>

</div>
</div>


<div class='lab-content__end-lab-button js-end-lab-button-container hidden'>
<ql-lab-control-button class='js-end-lab-button' running></ql-lab-control-button>
</div>
<!-- / TODO: Move recommendations into the end lab modal -->
<div class='lab-content__renderable-instructions'>
<div class='lab-content__recommendation'>
<!-- # TODO: Change classes so that this doesn't stack vertically -->
<section class='upcoming-cards'>
<h2 class='ql-headline-4'>Continue questing</h2>
<div class='activity-cards'>
<ql-activity-card aria-label='Migrate to Cloud SQL for PostgreSQL using Database Migration Service' name='Migrate to Cloud SQL for PostgreSQL using Database Migration Service' path='/focuses/23649?parent=catalog' progress='0.0' type='lab'></ql-activity-card>

</div>
</section>

</div>

</div>
</ql-drawer-content>
<ql-drawer end id='outline-drawer' open slot='drawer' width='320'>
<div aria-label='Lab Table of Contents' role='navigation'>
<ul class='lab-content__outline js-lab-content-outline'>
<li><a href="#step1">GSP021</a></li><li><a href="#step2">Overview</a></li><li><a href="#step3">Setup and requirements</a></li><li><a href="#step4">Task 1. Get the sample code</a></li><li><a href="#step5">Task 2. Quick Kubernetes Demo</a></li><li><a href="#step6">Task 3. Pods</a></li><li><a href="#step7">Task 4. Creating pods</a></li><li><a href="#step8">Task 5. Interacting with pods</a></li><li><a href="#step9">Task 6. Services</a></li><li><a href="#step10">Task 7. Creating a service</a></li><li><a href="#step11">Task 8. Adding labels to pods</a></li><li><a href="#step12">Task 9. Deploying applications with Kubernetes</a></li><li><a href="#step13">Task 10. Creating deployments</a></li><li><a href="#step14">Congratulations!</a></li>
</ul>
</div>
</ql-drawer>
</ql-drawer-container>
</ql-drawer-content>
</ql-drawer-container>



</div>
</main>

<span class='hidden' id='flash-sibling-before'></span>
<ql-snackbar></ql-snackbar>


<div class='modal fade' id='lab-details-modal'>
<div class='modal-container'>
<div class='modal-content mdl-shadow--24dp'>
<div class='modal-body'>
<p class='l-mbm'>
In this lab you will learn how to provision a complete Kubernetes cluster using Google Kubernetes Engine; deploy and manage Docker containers using kubectl; and break an application into microservices using Kubernetes’ Deployments and Services.
</p>
<p>
This lab is included in these quests:
<a href="/quests/121">Deploy and Manage Cloud Environments with Google Cloud</a>, <a href="/quests/24">Cloud Architecture</a>, <a href="/quests/29">Kubernetes in Google Cloud</a>, <a href="/quests/116">Deploy to Kubernetes in Google Cloud</a>, <a href="/quests/228">Qwiklabs Trivia September 2022</a>.
If you complete this lab you&#39;ll receive credit for it when you enroll in one of these quests.
</p>
<p class='small-label l-mbs'>
<strong>
Duration:
</strong>
0m setup
&middot;
75m access
&middot;
75m completion
</p>
<p class='small-label l-mbs'>
<strong>AWS Region:</strong>
[] <strong></strong>
</p>
<p class='small-label l-mbs'>
<span><strong>Levels: </strong>introductory</span>
</p>
<p class='small-label'>
<strong>
Permalink:
</strong>
<a href="https://partner.cloudskillsboost.google/catalog_lab/486">https://partner.cloudskillsboost.google/catalog_lab/486</a>
</p>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Got It
</a>
</div>


</div>
</div>
<iframe class='l-ie-iframe-fix' tabindex='-1' title='modal'></iframe>
</div>
<ql-dialog headline='How satisfied are you with this lab?&lt;span aria-hidden=&quot;true&quot;&gt;*&lt;/span&gt;' id='lab-review-dialog'>
<form class="simple_form js-lab-review-form" id="edit_lab_review_29758359" action="/lab_reviews/29758359" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" autocomplete="off" /><input type="hidden" name="_method" value="patch" autocomplete="off" /><div aria-labelledby='lab-review-dialog' aria-required='true' aria-valuemax='5' aria-valuemin='0' aria-valuenow='5' class='rateit js-rateit' data-rateit-max='5' data-rateit-min='0' data-rateit-resetable='false' data-rateit-step='1' data-rateit-value='5' id='lab-review-rateit' role='slider' tabindex='0'></div>
<div class='l-mtm'>

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" autocomplete="off" type="hidden" value="11061062" name="lab_review[user_id]" id="lab_review_user_id" /></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" autocomplete="off" type="hidden" name="lab_review[classroom_id]" id="lab_review_classroom_id" /></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" autocomplete="off" type="hidden" value="486" name="lab_review[lab_id]" id="lab_review_lab_id" /></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" autocomplete="off" type="hidden" name="lab_review[focus_id]" id="lab_review_focus_id" /></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" autocomplete="off" type="hidden" value="2" name="lab_review[rating]" id="lab_review_rating" /></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Additional Comments</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment">
</textarea></div></div>
</div>
</form><ql-button disabled id='submit' label='Submit' slot='action' text></ql-button>
</ql-dialog>

<ql-dialog headline='All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?' icon='error_outline' id='js-lab-are-you-sure-dialog'>
<ql-button id='js-are-you-sure-button' label='Submit' slot='action' text></ql-button>
</ql-dialog>


<script>
  $(function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    ql.favoriting.init();
  ql.chat.init();
  ql.jumpContent.init();
  ql.labControlPanel.addRecaptchaErrorHandler();
  initLabContent();
  ql.labOutline.links.init();
  initLabReviewModal();
  initLabReviewTranslations( {"star_amount_1":"1 of 5 stars","star_amount_2":"2 of 5 stars","star_amount_3":"3 of 5 stars","star_amount_4":"4 of 5 stars","star_amount_5":"5 of 5 stars"} )
  ql.labAssessment.init();
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>

</body>
</html>

